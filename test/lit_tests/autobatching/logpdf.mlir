// RUN: enzymexlamlir-opt --pass-pipeline="any(mark-func-memory-effects{assume_no_memory_effects=false max_iterations=8},inline{default-pipeline=canonicalize inlining-threshold=4294967295 max-iterations=4 },propagate-constant-bounds,sroa-wrappers{attributor=true dump_postllvm=false dump_prellvm=false instcombine=false instsimplify=true set_private=true sroa=true},canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},sroa-wrappers{attributor=true dump_postllvm=false dump_prellvm=false instcombine=false instsimplify=true set_private=true sroa=true},libdevice-funcs-raise{remove_freeze=true},canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},remove-duplicate-func-def,canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},cse,canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);recognize_extend;recognize_wrap;recognize_rotate;recognize_updatewithoutcorners;dusdus_to_dusextend radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);lower_extend;lower_wrap;lower_rotate;lower_updatewithoutcorners radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,enzyme-batch,inline{default-pipeline=canonicalize inlining-threshold=4294967295 max-iterations=4 },canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},cse,canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);recognize_extend;recognize_wrap;recognize_rotate;recognize_updatewithoutcorners;dusdus_to_dusextend radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);lower_extend;lower_wrap;lower_rotate;lower_updatewithoutcorners radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,enzyme{postpasses=arith-raise{stablehlo=true},canonicalize,cse,canonicalize,remove-unnecessary-enzyme-ops,enzyme-simplify-math,canonicalize,cse,canonicalize,arith-raise{stablehlo=true} verifyPostPasses=true},inline{default-pipeline=canonicalize inlining-threshold=4294967295 max-iterations=4 },canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},cse,canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);recognize_extend;recognize_wrap;recognize_rotate;recognize_updatewithoutcorners;dusdus_to_dusextend radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);lower_extend;lower_wrap;lower_rotate;lower_updatewithoutcorners radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},remove-unnecessary-enzyme-ops,enzyme-simplify-math,inline{default-pipeline=canonicalize inlining-threshold=4294967295 max-iterations=4 },canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},cse,canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);recognize_extend;recognize_wrap;recognize_rotate;recognize_updatewithoutcorners;dusdus_to_dusextend radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,enzyme-hlo-generate-td{create-module=false flags= patterns=compare_op_canon<16>;transpose_transpose<16>;broadcast_in_dim_op_canon<16>;convert_op_canon<16>;dynamic_broadcast_in_dim_op_not_actually_dynamic<16>;chained_dynamic_broadcast_in_dim_canonicalization<16>;dynamic_broadcast_in_dim_all_dims_non_expanding<16>;noop_reduce_op_canon<16>;empty_reduce_op_canon<16>;dynamic_reshape_op_canon<16>;get_tuple_element_op_canon<16>;real_op_canon<16>;imag_op_canon<16>;conj_complex_negate<16>;get_dimension_size_op_canon<16>;reshape_op_canon<16>;merge_consecutive_reshapes<16>;transpose_is_reshape<16>;zero_extent_tensor_canon<16>;cse_broadcast_in_dim<16>;cse_slice<16>;cse_transpose<16>;cse_convert<16>;cse_dot_general<16>;cse_reshape<16>;cse_mul<16>;cse_div<16>;cse_add<16>;cse_subtract<16>;cse_min<16>;cse_max<16>;cse_neg<16>;cse_abs<16>;cse_concatenate<16>;cse_compare<16>;cse_select<16>;concatenate_op_canon<16>(1024);select_op_canon<16>(1024);add_simplify<16>;sub_simplify<16>;and_simplify<16>;max_simplify<16>;min_simplify<16>;or_simplify<16>;xor_simplify<16>;mul_simplify<16>;div_simplify<16>;rem_simplify<16>;pow_simplify<16>;simplify_extend<16>;simplify_wrap<16>;simplify_rotate<16>;extend_splat<16>;noop_slice<16>;noop_reverse<16>;slice_slice<16>;dynamic_slice_slice<16>;slice_dynamic_slice<16>;dynamic_slice_dynamic_slice<16>;shift_right_logical_simplify<16>;slice_simplify<16>;convert_simplify<16>;dynamic_slice_to_static<16>;dynamic_update_slice_elim<16>;concat_to_broadcast<16>;reduce_to_reshape<16>;broadcast_to_reshape<16>;slice_internal;iota_simplify<16>(1024);broadcast_in_dim_simplify<16>(1024);convert_concat<1>;dynamic_update_to_concat<1>;slice_of_dynamic_update<1>;slice_elementwise<1>;dot_reshape_dot<1>;concat_fuse<1>;concat_push_binop_add<1>;concat_push_binop_mul<1>;reduce_concat<1>;slice_concat<1>;concat_slice<1>;select_op_used_within_if<1>;bin_broadcast_splat_add<1>;bin_broadcast_splat_subtract<1>;bin_broadcast_splat_div<1>;bin_broadcast_splat_mul<1>;dot_general_simplify<16>;transpose_simplify<16>;reshape_empty_broadcast<1>;broadcast_reshape<1>;transpose_dot_reorder<1>;dot_transpose<1>;transpose_convolution<1>;convolution_transpose<1>;convert_convert_float<1>;convert_convert_int<1>;reshape_iota<1>;broadcast_reduce<1>;slice_dot_general<1>;if_inline<1>;if_to_select<1>;divide_sqrt_to_multiply_rsqrt<16>;associative_binary_op_reordering<1>;transpose_broadcast_in_dim_to_broadcast_in_dim<16>;replace_neg_add_with_subtract;replace_subtract_neg_with_add;binop_const_simplify;not_select_simplify;common_compare_expression_rewrite;compare_select_simplify;while_simplify<1>(1);if_remove_unused;transpose_reshape_to_broadcast;reshape_transpose_to_broadcast;reshape_broadcast;dus_dus;dus_dus_concat;abs_positive_simplify;transpose_elementwise_transpose;select_comp_iota_const_simplify<1>;sign_abs_simplify<1>;broadcastindim_is_reshape;reduce_window_wrap<1>;slice_reduce_window<1>;while_deadresult;while_idempotent_dus;while_dus;while_updatewithoutcorners;while_op_induction_replacement;dus_concat;dusdus_to_duspad;slice_dus_to_concat;sink_dus;hoist_slice;while_induction_reduction;slice_broadcast;associative_common_mul_op_reordering;slice_select_to_select_slice;slice_if;dus_to_i32;slice_extend;slice_of_updatewithoutcorners;concat_wrap;cse_updatewithoutcorners<16>;cse_extend<16>;cse_wrap<16>;cse_rotate<16>;concat_concat_axis_swap;concat_concat_to_dus;broadcast_iota_simplify;select_comp_iota_to_dus;compare_cleanup;broadcast_compare;not_compare;broadcast_iota;cse_iota;compare_iota_const_simplify;reshuffle_ands_compares;square_abs_simplify;divide_divide_simplify;concat_reshape_slice;full_reduce_reshape_or_transpose;concat_reshape_reduce;concat_elementwise;reduce_reduce;conj_real;select_broadcast_in_dim;if_op_lift_common_ops;involution_neg_simplify;involution_conj_simplify;involution_not_simplify;real_conj_simplify;conj_complex_simplify;split_convolution_into_reverse_convolution;power_multiply_to_power;log_simplify;neg_mul_const_simplify;neg_div_const_simplify;reshape_deletions_broadcast_in_dim_simplify;reshape_insertions_broadcast_in_dim_simplify;dot_general_reshape;widen_wrap;widen_extend;elementwise_pad;compare_negate_const_simplify;select_simplify;concatenate_subtract_to_subtract_pad;concatenate_broadcast_in_dim;compare_abs;compare_convert;add_selects;self_subtract_to_convolution_like(0);self_add_to_convolution_like(0);self_mul_to_convolution_like(0);subtract_multiply_const_to_add_mul_const;trivial_reduce_window_to_reduce_op;case_to_if;dot_general_add_distributive_simplify;dot_general_subtract_distributive_simplify;remove_no_ops_from_while_loop;while_is_copy_simplify;split_variadic_scatter_op;dynamic_slice_simplify;enzyme_hlo_unroll(4);divide_negated_operands_simplify;multiply_negated_operands_simplify;factor_scalars_in_dot_general;reduce_mul_to_dot_general;dot_general_broadcast_in_dim;dot_general_broadcast_in_dim_sort_dims;dus_dynamic_slice_simplify;while_dus_dus_simplify;while_dus_ds_simplify;reshape_slice_reshape;dynamic_slice_elementwise;dot_general_remove_batch_dimensions;delete_dims_reduce;reduce_delete_dims;dot_general_insert_dim_contraction_simplification;fuse_reshape_collapse_or_expand_dims_into_reduce;split_reduce_add_mul_to_add_dot_general;recognize_from_constant(1024);transpose_syrk_to_syrk;fuse_mul_into_syrk;fuse_add_into_syrk;dot_general_only_diagonal_access;transpose_symmetric_simplify;syrk_simplify_output_uplo;scatter_op_canon<16>;scatter_to_dynamic_update_slice<1>;scatter_multiply_simplify;scatter_sub_simplify;scatter_add_simplify;scatter_div_simplify;unary_elementwise_scatter_simplify;scatter_indices_are_unique;scatter_update_computation_const_prop;dynamic_gather_op_is_not_dynamic<16>;gather_op_canon<16>;gather_elementwise;gather_of_scatter_simplify;gather_const_prop;scatter_const_fold(1024);cse_gather;cse_scatter;diagonal_tensor_dot_general_rewrite;add_reduce_slice_fusion;mul_reduce_slice_fusion;min_reduce_slice_fusion;max_reduce_slice_fusion;and_reduce_slice_fusion;xor_reduce_slice_fusion;or_reduce_slice_fusion;concat_insert_dim_dot_general;concat_insert_dim_gather;concat_insert_dim_iota;concat_insert_dim_reduce;concat_insert_dim_sort;concat_insert_dim_reduce_window;concat_insert_dim_elementwise;concat_insert_dim_convolution;greedy_while_loop_batch_fission;while_elementwise_reduction_to_reduce;remove_loop_carried_dependencies_from_while_load_operations;dus_licm(0);slice_licm(0);elementwise_licm(0);concatenate_licm(0);while_licm<1>(1);transpose_licm(0);broadcastindim_licm(0);reshape_licm(0);dot_general_licm(0);reduce_licm(0);reduce_window_licm(0);reverse_licm(0);convolution_licm(0);dynamic_slice_licm(0);scatter_licm(0);gather_licm(0);iota_licm(0);rotate_licm(0);wrap_licm(0);extend_licm(0);extend_pad;dus_pad;cse_pad<16>;pad_simplify<16>(1024);select_pad_to_dus<1>;and_pad_pad<1>;negative_pad_to_slice<16>;slice_pad<1>;pad_reshape_pad<1>;pad_pad<1>;add_pad_pad_to_concat<1>;concat_pad<1>;reduce_pad<1>;broadcast_pad<1>;zero_product_reshape_pad<1>;mul_zero_pad<1>;div_zero_pad<1>;binop_const_reshape_pad<1>;binop_const_pad_add<1>;binop_const_pad_subtract<1>;binop_const_pad_mul<1>;binop_const_pad_div<1>;binop_binop_pad_pad_add<1>;binop_binop_pad_pad_mul<1>;binop_pad_pad_add<1>;binop_pad_pad_subtract<1>;binop_pad_pad_mul<1>;binop_pad_pad_div<1>;binop_pad_pad_min<1>;binop_pad_pad_max<1>;unary_pad_push_convert<1>;unary_pad_push_tanh<1>;unary_pad_push_exp<1>;concat_to_pad<1>;while_pad_induction_reduction;pad_concat_to_concat_pad;rotate_pad;concat_multipad;speculate_if_pad_to_select;dus_to_dynamic_pad;dynamic_pad_to_pad;pad_licm(0);chlo_inf_const_prop<16>;gamma_const_prop<16>;abs_const_prop<16>;log_const_prop<1>;log_plus_one_const_prop<1>;is_finite_const_prop;not_const_prop;neg_const_prop;sqrt_const_prop;rsqrt_const_prop;cos_const_prop;sin_const_prop;exp_const_prop;expm1_const_prop;tanh_const_prop;logistic_const_prop;conj_const_prop;ceil_const_prop;cbrt_const_prop;real_const_prop;imag_const_prop;round_const_prop;round_nearest_even_const_prop;sign_const_prop;floor_const_prop;tan_const_prop;add_const_prop;and_const_prop;atan2_const_prop;complex_const_prop;div_const_prop;max_const_prop;min_const_prop;mul_const_prop;or_const_prop;pow_const_prop;rem_const_prop;sub_const_prop;xor_const_prop;const_prop_through_barrier<16>;concat_const_prop<1>(1024);dynamic_update_slice_const_prop(1024);clamp_const_prop;dus_slice_simplify;reshape_concat;reshape_dus;dot_reshape_pad<1>;pad_dot_general<1>(0);reshape_pad;reshape_wrap;reshape_rotate;reshape_extend;delete_dims_broadcast;reshape_slice(1);reshape_elementwise(1);reshape_dynamic_slice(1);transpose_select;transpose_while;transpose_slice;transpose_concat;transpose_iota;transpose_reduce;transpose_reduce_window;transpose_dus;transpose_pad<1>;transpose_einsum<1>;transpose_wrap;transpose_extend;transpose_rotate;transpose_dynamic_slice;transpose_reverse;transpose_batch_norm_training;transpose_batch_norm_inference;transpose_batch_norm_grad;transpose_if;transpose_fft;transpose_reshape;transpose_elementwise(1);no_nan_compare_simplify(0);no_nan_self_sub_simplify(0);no_nan_add_sub_simplify(0);no_nan_mul_simplify(0);no_nan_div_simplify(0);lower_extend;lower_wrap;lower_rotate;lower_updatewithoutcorners radix=10},transform-interpreter{ debug-payload-root-tag= disable-expensive-checks=false entry-point=__transform_main},enzyme-hlo-remove-transform,lower-kernel{backend=cpu},canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},canonicalize{  max-iterations=10 max-num-rewrites=-1 region-simplify=normal test-convergence=false top-down=true},lower-enzymexla-linalg{backend=cpu blas_int_width=64},lower-enzymexla-blas{backend=cpu blas_int_width=64},lower-enzymexla-lapack{backend=cpu blas_int_width=64},lower-enzymexla-mpi{backend=cpu},lower-jit{backend=cpu compileLaunch=true cuOptLevel=2 cuResultHandlerPtr=0 cuStreamSynchronizePtr=0 cubinChip=sm_50 cubinFeatures=+ptx60 cubinFormat=bin cubinTriple=nvptx64-nvidia-cuda debug=false indexBitWidth=64 jit=true linkFiles= openmp=true run_init=false toolkitPath=},symbol-dce)" %s | FileCheck %s

#loc1 = loc("arg2 (path=(:args, 2))")
module {
  func.func @logpdf(%arg0: tensor<6x6xf64> loc("arg2 (path=(:args, 2))")) -> (tensor<f64>, tensor<6x6xf64>) {
    %0 = stablehlo.transpose %arg0, dims = [1, 0] : (tensor<6x6xf64>) -> tensor<6x6xf64> loc(#loc)
    %c = stablehlo.constant dense<0> : tensor<i64> loc(#loc13)
    %1 = stablehlo.convert %c : (tensor<i64>) -> tensor<f64> loc(#loc14)
    %c_0 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
    %2 = stablehlo.convert %c_0 : tensor<i64> loc(#loc14)
    %c_1 = stablehlo.constant dense<6> : tensor<i64> loc(#loc13)
    %3 = stablehlo.convert %c_1 : tensor<i64> loc(#loc14)
    %c_2 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
    %4 = stablehlo.convert %c_2 : tensor<i64> loc(#loc14)
    %c_3 = stablehlo.constant dense<0> : tensor<i64> loc(#loc13)
    %5 = stablehlo.convert %c_3 : tensor<i64> loc(#loc14)
    %cst = stablehlo.constant dense<0.010000000000000002> : tensor<f64> loc(#loc13)
    %6 = stablehlo.convert %cst : tensor<f64> loc(#loc14)
    %7:7 = stablehlo.while(%iterArg = %5, %iterArg_7 = %4, %iterArg_8 = %3, %iterArg_9 = %2, %iterArg_10 = %0, %iterArg_11 = %1, %iterArg_12 = %6) : tensor<i64>, tensor<i64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<f64> attributes {enzyme.disable_mincut}
    cond {
      %16 = stablehlo.subtract %iterArg_8, %iterArg_9 : tensor<i64> loc(#loc16)
      %17 = stablehlo.divide %16, %iterArg_7 : tensor<i64> loc(#loc17)
      %c_13 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
      %18 = stablehlo.convert %c_13 : tensor<i64> loc(#loc14)
      %19 = stablehlo.add %17, %18 : tensor<i64> loc(#loc18)
      %20 = stablehlo.compare  LT, %iterArg, %19 : (tensor<i64>, tensor<i64>) -> tensor<i1> loc(#loc19)
      stablehlo.return %20 : tensor<i1> loc(#loc)
    } do {
      %16 = stablehlo.multiply %iterArg, %iterArg_7 : tensor<i64> loc(#loc20)
      %17 = stablehlo.add %iterArg_9, %16 : tensor<i64> loc(#loc18)
      %c_13 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
      %18 = stablehlo.convert %c_13 : tensor<i64> loc(#loc14)
      %19 = stablehlo.add %iterArg, %18 : tensor<i64> loc(#loc18)
      %c_14 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
      %20 = stablehlo.convert %c_14 : tensor<i64> loc(#loc14)
      %c_15 = stablehlo.constant dense<6> : tensor<i64> loc(#loc13)
      %21 = stablehlo.convert %c_15 : tensor<i64> loc(#loc14)
      %c_16 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
      %22 = stablehlo.convert %c_16 : tensor<i64> loc(#loc14)
      %c_17 = stablehlo.constant dense<0> : tensor<i64> loc(#loc13)
      %23 = stablehlo.convert %c_17 : tensor<i64> loc(#loc14)
      %24:8 = stablehlo.while(%iterArg_18 = %23, %iterArg_19 = %22, %iterArg_20 = %20, %iterArg_21 = %21, %iterArg_22 = %iterArg_10, %iterArg_23 = %iterArg_11, %iterArg_24 = %iterArg_12, %iterArg_25 = %17) : tensor<i64>, tensor<i64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<f64>, tensor<i64> attributes {enzyme.disable_mincut}
      cond {
        %25 = stablehlo.subtract %iterArg_21, %iterArg_20 : tensor<i64> loc(#loc16)
        %26 = stablehlo.divide %25, %iterArg_19 : tensor<i64> loc(#loc17)
        %c_26 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
        %27 = stablehlo.convert %c_26 : tensor<i64> loc(#loc14)
        %28 = stablehlo.add %26, %27 : tensor<i64> loc(#loc18)
        %29 = stablehlo.compare  LT, %iterArg_18, %28 : (tensor<i64>, tensor<i64>) -> tensor<i1> loc(#loc19)
        stablehlo.return %29 : tensor<i1> loc(#loc)
      } do {
        %25 = stablehlo.multiply %iterArg_18, %iterArg_19 : tensor<i64> loc(#loc20)
        %26 = stablehlo.add %iterArg_20, %25 : tensor<i64> loc(#loc18)
        %c_26 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
        %27 = stablehlo.convert %c_26 : tensor<i64> loc(#loc14)
        %28 = stablehlo.add %iterArg_18, %27 : tensor<i64> loc(#loc18)
        %c_27 = stablehlo.constant dense<4> : tensor<i64> loc(#loc13)
        %29 = stablehlo.convert %c_27 : (tensor<i64>) -> tensor<f64> loc(#loc14)
        %30 = stablehlo.add %29, %iterArg_24 : tensor<f64> loc(#loc18)
        %31 = stablehlo.convert %26 : (tensor<i64>) -> tensor<i32> loc(#loc21)
        %c_28 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
        %32 = stablehlo.convert %c_28 : tensor<i32> loc(#loc14)
        %33 = stablehlo.subtract %31, %32 : tensor<i32> loc(#loc16)
        %34 = stablehlo.convert %iterArg_25 : (tensor<i64>) -> tensor<i32> loc(#loc21)
        %c_29 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
        %35 = stablehlo.convert %c_29 : tensor<i32> loc(#loc14)
        %36 = stablehlo.subtract %34, %35 : tensor<i32> loc(#loc16)
        %37 = stablehlo.dynamic_slice %iterArg_22, %33, %36, sizes = [1, 1] : (tensor<6x6xf64>, tensor<i32>, tensor<i32>) -> tensor<1x1xf64> loc(#loc22)
        %38 = stablehlo.transpose %37, dims = [1, 0] : (tensor<1x1xf64>) -> tensor<1x1xf64> loc(#loc23)
        %39 = stablehlo.reshape %38 : (tensor<1x1xf64>) -> tensor<f64> loc(#loc24)
        %40 = stablehlo.transpose %39, dims = [] : (tensor<f64>) -> tensor<f64> loc(#loc23)
        %41 = stablehlo.multiply %30, %40 : tensor<f64> loc(#loc20)
        %c_30 = stablehlo.constant dense<6> : tensor<i64> loc(#loc13)
        %42 = stablehlo.convert %c_30 : tensor<i64> loc(#loc14)
        %43 = stablehlo.compare  LT, %26, %42 : (tensor<i64>, tensor<i64>) -> tensor<i1> loc(#loc19)
        %44:8 = "stablehlo.if"(%43) ({
          %c_36 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
          %66 = stablehlo.convert %c_36 : tensor<i64> loc(#loc14)
          %67 = stablehlo.add %26, %66 : tensor<i64> loc(#loc18)
          %68 = stablehlo.convert %67 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_37 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %69 = stablehlo.convert %c_37 : tensor<i32> loc(#loc14)
          %70 = stablehlo.subtract %68, %69 : tensor<i32> loc(#loc16)
          %71 = stablehlo.convert %iterArg_25 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_38 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %72 = stablehlo.convert %c_38 : tensor<i32> loc(#loc14)
          %73 = stablehlo.subtract %71, %72 : tensor<i32> loc(#loc16)
          %74 = stablehlo.dynamic_slice %iterArg_22, %70, %73, sizes = [1, 1] : (tensor<6x6xf64>, tensor<i32>, tensor<i32>) -> tensor<1x1xf64> loc(#loc22)
          %75 = stablehlo.transpose %74, dims = [1, 0] : (tensor<1x1xf64>) -> tensor<1x1xf64> loc(#loc23)
          %76 = stablehlo.reshape %75 : (tensor<1x1xf64>) -> tensor<f64> loc(#loc24)
          %77 = stablehlo.transpose %76, dims = [] : (tensor<f64>) -> tensor<f64> loc(#loc23)
          %78 = stablehlo.subtract %41, %77 : tensor<f64> loc(#loc16)
          stablehlo.return %iterArg_22, %41, %iterArg_25, %26, %iterArg_22, %78, %iterArg_25, %26 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }, {
          stablehlo.return %iterArg_22, %41, %iterArg_25, %26, %iterArg_22, %41, %iterArg_25, %26 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }) : (tensor<i1>) -> (tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>) loc(#loc25)
        %c_31 = stablehlo.constant dense<6> : tensor<i64> loc(#loc13)
        %45 = stablehlo.convert %c_31 : tensor<i64> loc(#loc14)
        %46 = stablehlo.compare  LT, %44#6, %45 : (tensor<i64>, tensor<i64>) -> tensor<i1> loc(#loc19)
        %47:8 = "stablehlo.if"(%46) ({
          %c_36 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
          %66 = stablehlo.convert %c_36 : tensor<i64> loc(#loc14)
          %67 = stablehlo.add %44#6, %66 : tensor<i64> loc(#loc18)
          %68 = stablehlo.convert %44#7 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_37 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %69 = stablehlo.convert %c_37 : tensor<i32> loc(#loc14)
          %70 = stablehlo.subtract %68, %69 : tensor<i32> loc(#loc16)
          %71 = stablehlo.convert %67 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_38 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %72 = stablehlo.convert %c_38 : tensor<i32> loc(#loc14)
          %73 = stablehlo.subtract %71, %72 : tensor<i32> loc(#loc16)
          %74 = stablehlo.dynamic_slice %44#4, %70, %73, sizes = [1, 1] : (tensor<6x6xf64>, tensor<i32>, tensor<i32>) -> tensor<1x1xf64> loc(#loc22)
          %75 = stablehlo.transpose %74, dims = [1, 0] : (tensor<1x1xf64>) -> tensor<1x1xf64> loc(#loc23)
          %76 = stablehlo.reshape %75 : (tensor<1x1xf64>) -> tensor<f64> loc(#loc24)
          %77 = stablehlo.transpose %76, dims = [] : (tensor<f64>) -> tensor<f64> loc(#loc23)
          %78 = stablehlo.subtract %44#5, %77 : tensor<f64> loc(#loc16)
          stablehlo.return %44#4, %44#5, %44#6, %44#7, %44#4, %78, %44#6, %44#7 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }, {
          stablehlo.return %44#4, %44#5, %44#6, %44#7, %44#4, %44#5, %44#6, %44#7 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }) : (tensor<i1>) -> (tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>) loc(#loc25)
        %c_32 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
        %48 = stablehlo.convert %c_32 : tensor<i64> loc(#loc14)
        %49 = stablehlo.compare  GT, %47#7, %48 : (tensor<i64>, tensor<i64>) -> tensor<i1> loc(#loc26)
        %50:8 = "stablehlo.if"(%49) ({
          %c_36 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
          %66 = stablehlo.convert %c_36 : tensor<i64> loc(#loc14)
          %67 = stablehlo.subtract %47#7, %66 : tensor<i64> loc(#loc16)
          %68 = stablehlo.convert %67 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_37 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %69 = stablehlo.convert %c_37 : tensor<i32> loc(#loc14)
          %70 = stablehlo.subtract %68, %69 : tensor<i32> loc(#loc16)
          %71 = stablehlo.convert %47#6 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_38 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %72 = stablehlo.convert %c_38 : tensor<i32> loc(#loc14)
          %73 = stablehlo.subtract %71, %72 : tensor<i32> loc(#loc16)
          %74 = stablehlo.dynamic_slice %47#4, %70, %73, sizes = [1, 1] : (tensor<6x6xf64>, tensor<i32>, tensor<i32>) -> tensor<1x1xf64> loc(#loc22)
          %75 = stablehlo.transpose %74, dims = [1, 0] : (tensor<1x1xf64>) -> tensor<1x1xf64> loc(#loc23)
          %76 = stablehlo.reshape %75 : (tensor<1x1xf64>) -> tensor<f64> loc(#loc24)
          %77 = stablehlo.transpose %76, dims = [] : (tensor<f64>) -> tensor<f64> loc(#loc23)
          %78 = stablehlo.subtract %47#5, %77 : tensor<f64> loc(#loc16)
          stablehlo.return %47#4, %47#5, %47#6, %47#7, %47#4, %78, %47#6, %47#7 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }, {
          stablehlo.return %47#4, %47#5, %47#6, %47#7, %47#4, %47#5, %47#6, %47#7 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }) : (tensor<i1>) -> (tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>) loc(#loc25)
        %c_33 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
        %51 = stablehlo.convert %c_33 : tensor<i64> loc(#loc14)
        %52 = stablehlo.compare  GT, %50#6, %51 : (tensor<i64>, tensor<i64>) -> tensor<i1> loc(#loc26)
        %53:8 = "stablehlo.if"(%52) ({
          %c_36 = stablehlo.constant dense<1> : tensor<i64> loc(#loc13)
          %66 = stablehlo.convert %c_36 : tensor<i64> loc(#loc14)
          %67 = stablehlo.subtract %50#6, %66 : tensor<i64> loc(#loc16)
          %68 = stablehlo.convert %50#7 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_37 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %69 = stablehlo.convert %c_37 : tensor<i32> loc(#loc14)
          %70 = stablehlo.subtract %68, %69 : tensor<i32> loc(#loc16)
          %71 = stablehlo.convert %67 : (tensor<i64>) -> tensor<i32> loc(#loc21)
          %c_38 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
          %72 = stablehlo.convert %c_38 : tensor<i32> loc(#loc14)
          %73 = stablehlo.subtract %71, %72 : tensor<i32> loc(#loc16)
          %74 = stablehlo.dynamic_slice %50#4, %70, %73, sizes = [1, 1] : (tensor<6x6xf64>, tensor<i32>, tensor<i32>) -> tensor<1x1xf64> loc(#loc22)
          %75 = stablehlo.transpose %74, dims = [1, 0] : (tensor<1x1xf64>) -> tensor<1x1xf64> loc(#loc23)
          %76 = stablehlo.reshape %75 : (tensor<1x1xf64>) -> tensor<f64> loc(#loc24)
          %77 = stablehlo.transpose %76, dims = [] : (tensor<f64>) -> tensor<f64> loc(#loc23)
          %78 = stablehlo.subtract %50#5, %77 : tensor<f64> loc(#loc16)
          stablehlo.return %50#4, %50#5, %50#6, %50#7, %50#4, %78, %50#6, %50#7 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }, {
          stablehlo.return %50#4, %50#5, %50#6, %50#7, %50#4, %50#5, %50#6, %50#7 : tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64> loc(#loc25)
        }) : (tensor<i1>) -> (tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<i64>, tensor<i64>) loc(#loc25)
        %54 = stablehlo.convert %44#3 : (tensor<i64>) -> tensor<i32> loc(#loc21)
        %c_34 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
        %55 = stablehlo.convert %c_34 : tensor<i32> loc(#loc14)
        %56 = stablehlo.subtract %54, %55 : tensor<i32> loc(#loc16)
        %57 = stablehlo.convert %44#2 : (tensor<i64>) -> tensor<i32> loc(#loc21)
        %c_35 = stablehlo.constant dense<1> : tensor<i32> loc(#loc13)
        %58 = stablehlo.convert %c_35 : tensor<i32> loc(#loc14)
        %59 = stablehlo.subtract %57, %58 : tensor<i32> loc(#loc16)
        %60 = stablehlo.dynamic_slice %44#0, %56, %59, sizes = [1, 1] : (tensor<6x6xf64>, tensor<i32>, tensor<i32>) -> tensor<1x1xf64> loc(#loc22)
        %61 = stablehlo.transpose %60, dims = [1, 0] : (tensor<1x1xf64>) -> tensor<1x1xf64> loc(#loc23)
        %62 = stablehlo.reshape %61 : (tensor<1x1xf64>) -> tensor<f64> loc(#loc24)
        %63 = stablehlo.transpose %62, dims = [] : (tensor<f64>) -> tensor<f64> loc(#loc23)
        %64 = stablehlo.multiply %53#5, %63 : tensor<f64> loc(#loc20)
        %65 = stablehlo.add %iterArg_23, %64 : tensor<f64> loc(#loc18)
        stablehlo.return %28, %iterArg_19, %iterArg_20, %iterArg_21, %44#0, %65, %iterArg_24, %44#2 : tensor<i64>, tensor<i64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<f64>, tensor<i64> loc(#loc)
      } loc(#loc15)
      stablehlo.return %19, %iterArg_7, %iterArg_8, %iterArg_9, %24#4, %24#5, %24#6 : tensor<i64>, tensor<i64>, tensor<i64>, tensor<i64>, tensor<6x6xf64>, tensor<f64>, tensor<f64> loc(#loc)
    } loc(#loc15)
    %cst_4 = stablehlo.constant dense<1.010000e+00> : tensor<f64> loc(#loc13)
    %8 = stablehlo.convert %cst_4 : tensor<f64> loc(#loc14)
    %9 = stablehlo.divide %7#5, %8 : tensor<f64> loc(#loc27)
    %10 = stablehlo.negate %9 : tensor<f64> loc(#loc28)
    %c_5 = stablehlo.constant dense<2> : tensor<i64> loc(#loc13)
    %11 = stablehlo.convert %c_5 : (tensor<i64>) -> tensor<f64> loc(#loc14)
    %12 = stablehlo.divide %10, %11 : tensor<f64> loc(#loc27)
    %cst_6 = stablehlo.constant dense<-10.974465114022347> : tensor<f64> loc(#loc13)
    %13 = stablehlo.convert %cst_6 : tensor<f64> loc(#loc14)
    %14 = stablehlo.add %12, %13 : tensor<f64> loc(#loc18)
    %15 = stablehlo.transpose %7#4, dims = [1, 0] : (tensor<6x6xf64>) -> tensor<6x6xf64> loc(#loc)
    return %14, %15 : tensor<f64>, tensor<6x6xf64> loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc = loc(unknown)
#loc2 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedPromotion.jl":86:0)
#loc3 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedPromotion.jl":87:0)
#loc4 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/ControlFlow.jl":20:0)
#loc5 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedRNumber.jl":241:0)
#loc6 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedRNumber.jl":285:0)
#loc7 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedRNumber.jl":319:0)
#loc8 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedPromotion.jl":75:0)
#loc9 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/Indexing.jl":41:0)
#loc10 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/Ops.jl":608:0)
#loc11 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/ControlFlow.jl":4:0)
#loc12 = loc("/home/ptiede/.julia/packages/Reactant/gsixc/src/TracedRNumber.jl":527:0)
#loc13 = loc("promote_to/fill"(#loc2))
#loc14 = loc("promote_to/convert"(#loc3))
#loc15 = loc("traced_while/while_loop"(#loc4))
#loc16 = loc("-/subtract"(#loc5))
#loc17 = loc("div/divide"(#loc6))
#loc18 = loc("+/add"(#loc5))
#loc19 = loc("</compare"(#loc7))
#loc20 = loc("*/multiply"(#loc5))
#loc21 = loc("promote_to/convert"(#loc8))
#loc22 = loc("getindex/dynamic_slice"(#loc9))
#loc23 = loc("transpose"(#loc10))
#loc24 = loc("getindex/reshape"(#loc9))
#loc25 = loc("traced_if/if_condition"(#loc11))
#loc26 = loc(">/compare"(#loc7))
#loc27 = loc("/divide"(#loc5))
#loc28 = loc("-/negate"(#loc12))

// CHECK: func.func @logpdf
